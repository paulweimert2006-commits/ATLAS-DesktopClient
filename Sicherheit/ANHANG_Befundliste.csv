ID;Kategorie;Schweregrad;Ort;Kurzbeschreibung;Evidenz;Status
SV-001;Secrets;kritisch;src/services/pdf_unlock.py:23-35;Hardcoded PDF/ZIP-Passwoerter im Quellcode;4 Klartext-Passwoerter als Fallback;offen
SV-002;Server-Config;kritisch;api/index.php (global);Fehlende Security Headers (HSTS, X-Frame-Options, CSP, etc.);Kein header() fuer Security Headers in PHP;offen
SV-003;Auth;kritisch;api/auth.php;Kein Rate-Limiting auf Login-Endpoint;Kein Rate-Limiting-Code gefunden;offen
SV-004;Secrets;kritisch;api/ai.php:58;OpenRouter API-Key an Client exponiert;json_success(['key' => OPENROUTER_API_KEY]);offen
SV-005;Secrets;hoch;src/api/auth.py:295-305;JWT-Token im Klartext auf Disk gespeichert;~/.bipro_gdv_token.json ohne Permissions;offen
SV-006;Secrets;hoch;api/passwords.php:44;PDF/ZIP-Passwoerter in DB im Klartext;password_value ohne Verschluesselung;offen
SV-007;Input-Validation;hoch;src/services/zip_handler.py:99-149;Kein Zip-Bomb-Schutz (kein kumulatives Groessenlimit);Nur Rekursionslimit, kein Size-Tracking;offen
SV-008;Secrets;hoch;src/bipro/transfer_service.py:342-367;Temporaere PEM-Dateien mit Private Keys;Unverschluesselt auf Disk, Cleanup nur in close();offen
SV-009;Deployment;hoch;BiPro-Webspace Spiegelung Live/;Keine Umgebungs-Trennung (Dev = Prod);Ordner-Sync direkt auf Produktion;offen
SV-010;Secrets;hoch;src/config/certificates.py:203-204;Zertifikate unverschluesselt auf Disk;shutil.copy2 ohne Verschluesselung;offen
SV-011;Supply-Chain;hoch;requirements.txt;Keine Dependency-Lockfiles;Alle Dependencies mit >= ohne obere Grenze;offen
SV-012;SQL-Injection;mittel;api/gdv.php:255-263 + api/activity.php:108-127;SQL LIMIT/OFFSET per String-Interpolation;(int) Cast + Interpolation statt Prepared Statement;offen
SV-013;Datenschutz;mittel;src/api/openrouter.py + src/services/document_processor.py;PII-Daten an externen Dienst (OpenRouter);PDF-Text mit potentiellen PII an Drittanbieter;offen
SV-014;Datenschutz;mittel;src/bipro/transfer_service.py:616-617+814+1147;Potentielle PII in Debug-Logs;Versicherungsschein-Nr und Responses bei DEBUG-Level;offen
SV-015;Netzwerk;mittel;src/bipro/transfer_service.py:72-75+264;Proxy komplett deaktiviert;trust_env=False, Proxies explizit leer;offen
SV-016;TLS;mittel;src/api/client.py + transfer_service.py + update_service.py;Kein Certificate-Pinning;verify=True aber kein Pinning;offen
SV-017;Supply-Chain;mittel;build.bat + src/services/update_service.py;Kein Code-Signing fuer Installer;SHA256 aber kein Authenticode;offen
SV-018;Server-Config;mittel;BiPro-Webspace Spiegelung Live/setup/;Setup-Verzeichnis potentiell web-zugaenglich;Synchronisiert, kein .htaccess;unverifiziert
SV-019;Datenschutz;mittel;api/lib/activity_logger.php;Unbegrenzte Activity-Log-Retention;Kein Cleanup, IP/User-Agent gespeichert;offen
SV-020;Kryptographie;mittel;api/lib/crypto.php:100-103;Einfache Key-Derivation (SHA256 statt HKDF);hash('sha256', MASTER_KEY) statt HKDF;offen
SV-021;Input-Validation;mittel;api/documents.php:408;Keine MIME-Type-Validierung bei normalem Upload;MIME-Type optional bei Dokument-Upload;offen
SV-022;Supply-Chain;niedrig;api/lib/;Kein PHP Dependency-Management;Kein Composer, manuell verwaltete Libraries;offen
SV-023;Information-Disclosure;niedrig;api/index.php:40-44;API-Version im Health-Check exponiert;'version' => API_VERSION;offen
SV-024;Resource-Management;niedrig;src/services/pdf_unlock.py:155-161;Temp-File-Leak bei PDF-Unlock;mkstemp Cleanup nur bei Exception;offen
SV-025;Error-Handling;niedrig;src/services/msg_handler.py:102-110;Fehler bei MSG-Extraktion werden verschluckt;Exception silently caught;offen
SV-026;TLS;niedrig;src/config/certificates.py + transfer_service.py;Keine CRL/OCSP-Pruefung fuer Zertifikate;Kein Revocation-Check;offen
SV-027;Compliance;niedrig;requirements.txt;Potentielle Lizenz-Konflikte (AGPL/GPL);PyMuPDF AGPL + extract-msg GPL;unverifiziert
SV-028;Monitoring;niedrig;Gesamtsystem;Kein Monitoring und Alerting;Kein Uptime/APM/Error-Alerting;offen
SV-029;TLS;niedrig;api/lib/db.php;MySQL-Verbindung ohne nachweisbare TLS-Verschluesselung;Kein PDO::MYSQL_ATTR_SSL_CA;unverifiziert
SV-030;Testing;niedrig;src/tests/;Keine automatischen Security-Tests;Nur funktionale Tests vorhanden;offen
